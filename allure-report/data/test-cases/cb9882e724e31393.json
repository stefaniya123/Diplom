{"uid":"cb9882e724e31393","name":"Ожидается 'Истёк срок...', но получаем 'Неверно указан срок...' (11/25, покупка по карте)","fullName":"tests.test_ui.TestSuccessfulPurchase#test_wrong_expiry_date_card","historyId":"83b4ab4400335dbdea3ddd2cb31672a1","time":{"start":1765832724561,"stop":1765832731391,"duration":6830},"status":"failed","statusMessage":"AssertionError: Ожидалась 'Истёк срок...', но получено: ['Неверно указан срок действия карты']","statusTrace":"self = <tests.test_ui.TestSuccessfulPurchase testMethod=test_wrong_expiry_date_card>\n\n    @allure.feature(\"Оплата по карте\")\n    @allure.story(\"Баг: Некорректная ошибка при будущей дате\")\n    @allure.title(\"Ожидается 'Истёк срок...', но получаем 'Неверно указан срок...' (11/25, покупка по карте)\")\n    def test_wrong_expiry_date_card(self):\n        driver = self.driver\n    \n        with allure.step(\"Нажать кнопку 'Купить'\"):\n            buy_button = WebDriverWait(driver, 25).until(\n                EC.element_to_be_clickable((By.CSS_SELECTOR, \"button.button_size_m.button_theme_alfa-on-white\"))\n            )\n            driver.execute_script(\"arguments[0].scrollIntoView({block: 'center'});\", buy_button)\n            driver.execute_script(\"arguments[0].click();\", buy_button)\n    \n        with allure.step(\"Дождаться формы 'Оплата по карте'\"):\n            WebDriverWait(driver, 10).until(\n                EC.visibility_of_element_located((By.XPATH, \"//h3[text()='Оплата по карте']\"))\n            )\n    \n        with allure.step(\"Ввести будущую дату: месяц=11, год=25\"):\n            inputs = driver.find_elements(By.CSS_SELECTOR, \"input.input__control\")\n            inputs[0].send_keys(\"4444 4444 4444 4441\")\n            inputs[1].send_keys(\"11\")\n            inputs[2].send_keys(\"25\")\n            inputs[3].send_keys(\"иван\")\n            inputs[4].send_keys(\"999\")\n    \n        with allure.step(\"Нажать кнопку 'Продолжить'\"):\n            continue_button = WebDriverWait(driver, 10).until(\n                EC.element_to_be_clickable((By.XPATH,\n                                            \"//button[contains(@class, 'button_view_extra') and contains(@class, 'button_size_m') and contains(@class, 'button_theme_alfa-on-white') and not(contains(@class, 'button_disabled')) and contains(., 'Продолжить')]\"))\n            )\n            continue_button.click()\n    \n        with allure.step(\"Проверить, что появилась ОЖИДАЕМАЯ ошибка 'Истёк срок...' под 'Годом'\"):\n            error_elements = WebDriverWait(driver, 10).until(\n                EC.presence_of_all_elements_located((By.CSS_SELECTOR, \"span.input__sub\"))\n            )\n            self.assertGreater(len(error_elements), 0, \"Ошибки не появилось\")\n    \n            for i, err in enumerate(error_elements):\n                if err.text.strip() == \"Истёк срок действия карты\":\n                    if i == 2:  # ошибка под \"Годом\"\n                        return  # всё хорошо\n                    else:\n                        self.fail(f\"Ошибка 'Истёк срок...' под полем {i+1}, а не под 'Годом'\")\n            all_texts = [e.text.strip() for e in error_elements]\n>           self.fail(f\"Ожидалась 'Истёк срок...', но получено: {all_texts}\")\nE           AssertionError: Ожидалась 'Истёк срок...', но получено: ['Неверно указан срок действия карты']\n\ntests\\test_ui.py:354: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_unittest_setUpClass_fixture_TestSuccessfulPurchase","time":{"start":1765832591238,"stop":1765832591238,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0}],"testStage":{"status":"failed","statusMessage":"AssertionError: Ожидалась 'Истёк срок...', но получено: ['Неверно указан срок действия карты']","statusTrace":"self = <tests.test_ui.TestSuccessfulPurchase testMethod=test_wrong_expiry_date_card>\n\n    @allure.feature(\"Оплата по карте\")\n    @allure.story(\"Баг: Некорректная ошибка при будущей дате\")\n    @allure.title(\"Ожидается 'Истёк срок...', но получаем 'Неверно указан срок...' (11/25, покупка по карте)\")\n    def test_wrong_expiry_date_card(self):\n        driver = self.driver\n    \n        with allure.step(\"Нажать кнопку 'Купить'\"):\n            buy_button = WebDriverWait(driver, 25).until(\n                EC.element_to_be_clickable((By.CSS_SELECTOR, \"button.button_size_m.button_theme_alfa-on-white\"))\n            )\n            driver.execute_script(\"arguments[0].scrollIntoView({block: 'center'});\", buy_button)\n            driver.execute_script(\"arguments[0].click();\", buy_button)\n    \n        with allure.step(\"Дождаться формы 'Оплата по карте'\"):\n            WebDriverWait(driver, 10).until(\n                EC.visibility_of_element_located((By.XPATH, \"//h3[text()='Оплата по карте']\"))\n            )\n    \n        with allure.step(\"Ввести будущую дату: месяц=11, год=25\"):\n            inputs = driver.find_elements(By.CSS_SELECTOR, \"input.input__control\")\n            inputs[0].send_keys(\"4444 4444 4444 4441\")\n            inputs[1].send_keys(\"11\")\n            inputs[2].send_keys(\"25\")\n            inputs[3].send_keys(\"иван\")\n            inputs[4].send_keys(\"999\")\n    \n        with allure.step(\"Нажать кнопку 'Продолжить'\"):\n            continue_button = WebDriverWait(driver, 10).until(\n                EC.element_to_be_clickable((By.XPATH,\n                                            \"//button[contains(@class, 'button_view_extra') and contains(@class, 'button_size_m') and contains(@class, 'button_theme_alfa-on-white') and not(contains(@class, 'button_disabled')) and contains(., 'Продолжить')]\"))\n            )\n            continue_button.click()\n    \n        with allure.step(\"Проверить, что появилась ОЖИДАЕМАЯ ошибка 'Истёк срок...' под 'Годом'\"):\n            error_elements = WebDriverWait(driver, 10).until(\n                EC.presence_of_all_elements_located((By.CSS_SELECTOR, \"span.input__sub\"))\n            )\n            self.assertGreater(len(error_elements), 0, \"Ошибки не появилось\")\n    \n            for i, err in enumerate(error_elements):\n                if err.text.strip() == \"Истёк срок действия карты\":\n                    if i == 2:  # ошибка под \"Годом\"\n                        return  # всё хорошо\n                    else:\n                        self.fail(f\"Ошибка 'Истёк срок...' под полем {i+1}, а не под 'Годом'\")\n            all_texts = [e.text.strip() for e in error_elements]\n>           self.fail(f\"Ожидалась 'Истёк срок...', но получено: {all_texts}\")\nE           AssertionError: Ожидалась 'Истёк срок...', но получено: ['Неверно указан срок действия карты']\n\ntests\\test_ui.py:354: AssertionError","steps":[{"name":"Нажать кнопку 'Купить'","time":{"start":1765832728269,"stop":1765832728414,"duration":145},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Дождаться формы 'Оплата по карте'","time":{"start":1765832728414,"stop":1765832728441,"duration":27},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Ввести будущую дату: месяц=11, год=25","time":{"start":1765832728441,"stop":1765832728911,"duration":470},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Нажать кнопку 'Продолжить'","time":{"start":1765832728911,"stop":1765832729050,"duration":139},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Проверить, что появилась ОЖИДАЕМАЯ ошибка 'Истёк срок...' под 'Годом'","time":{"start":1765832729050,"stop":1765832729092,"duration":42},"status":"failed","statusMessage":"AssertionError: Ожидалась 'Истёк срок...', но получено: ['Неверно указан срок действия карты']\n","statusTrace":"  File \"C:\\Users\\St\\Desktop\\qapy-diplom_v2\\tests\\test_ui.py\", line 354, in test_wrong_expiry_date_card\n    self.fail(f\"Ожидалась 'Истёк срок...', но получено: {all_texts}\")\n    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\St\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\unittest\\case.py\", line 732, in fail\n    raise self.failureException(msg)\n","steps":[],"attachments":[],"parameters":[],"hasContent":true,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":true,"stepsCount":0}],"attachments":[],"parameters":[],"hasContent":true,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":true,"stepsCount":5},"afterStages":[{"name":"_unittest_setUpClass_fixture_TestSuccessfulPurchase::0","time":{"start":1765832740236,"stop":1765832740236,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0}],"labels":[{"name":"story","value":"Баг: Некорректная ошибка при будущей дате"},{"name":"feature","value":"Оплата по карте"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_ui"},{"name":"subSuite","value":"TestSuccessfulPurchase"},{"name":"host","value":"Kirilenko"},{"name":"thread","value":"24224-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_ui"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":[]},"source":"cb9882e724e31393.json","parameterValues":[]}