{"uid":"da8fde2c22ef2d47","name":"Карта 4444 4444 4444 4442 должна вызывать ошибку, но вызывает успех (покупка в кредит)","fullName":"tests.test_ui.TestSuccessfulPurchase#test_credit_4442_should_reject_but_approves","historyId":"bf289d87258a23e400956df1fbdfd781","time":{"start":1765832615627,"stop":1765832630685,"duration":15058},"status":"failed","statusMessage":"AssertionError: Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\nЗаголовок: 'Успешно'\nСодержимое: 'Операция одобрена Банком.'","statusTrace":"self = <tests.test_ui.TestSuccessfulPurchase testMethod=test_credit_4442_should_reject_but_approves>\n\n    @allure.feature(\"Покупка в кредит\")\n    @allure.story(\"Баг: Некорректная обработка отказа банка\")\n    @allure.title(\"Карта 4444 4444 4444 4442 должна вызывать ошибку, но вызывает успех (покупка в кредит)\")\n    def test_credit_4442_should_reject_but_approves(self):\n        driver = self.driver\n    \n        with allure.step(\"Нажать кнопку 'Купить в кредит'\"):\n            credit_button = WebDriverWait(driver, 25).until(\n                EC.element_to_be_clickable((By.XPATH,\n                                            \"//button[contains(@class, 'button_view_extra') and contains(@class, 'button_size_m') and contains(@class, 'button_theme_alfa-on-white') and contains(., 'Купить в кредит')]\"))\n            )\n            driver.execute_script(\"arguments[0].scrollIntoView({block: 'center'});\", credit_button)\n            driver.execute_script(\"arguments[0].click();\", credit_button)\n    \n        with allure.step(\"Дождаться формы 'Кредит по данным карты'\"):\n            WebDriverWait(driver, 10).until(\n                EC.visibility_of_element_located((By.XPATH, \"//h3[text()='Кредит по данным карты']\"))\n            )\n    \n        with allure.step(\"Заполнить форму данными карты 4444 4444 4444 4442\"):\n            inputs = driver.find_elements(By.CSS_SELECTOR, \"input.input__control\")\n            inputs[0].send_keys(\"4444 4444 4444 4442\")\n            inputs[1].send_keys(\"08\")\n            inputs[2].send_keys(\"26\")\n            inputs[3].send_keys(\"иван\")\n            inputs[4].send_keys(\"999\")\n    \n        with allure.step(\"Нажать кнопку 'Продолжить'\"):\n            continue_button = WebDriverWait(driver, 10).until(\n                EC.element_to_be_clickable((By.XPATH,\n                                            \"//button[contains(@class, 'button_view_extra') and contains(@class, 'button_size_m') and contains(@class, 'button_theme_alfa-on-white') and not(contains(@class, 'button_disabled')) and contains(., 'Продолжить')]\"))\n            )\n            continue_button.click()\n    \n        with allure.step(\"Дождаться появления ЛЮБОГО уведомления\"):\n            notification = WebDriverWait(driver, 25).until(\n                EC.visibility_of_element_located((By.CSS_SELECTOR, \"div.notification\"))\n            )\n    \n        with allure.step(\"Проверить, что уведомление — НЕ об успехе, а об ошибке\"):\n            notification_class = notification.get_attribute(\"class\")\n    \n            if \"notification_status_ok\" in notification_class:\n                title = notification.find_element(By.CSS_SELECTOR, \".notification__title\").text.strip()\n                content = notification.find_element(By.CSS_SELECTOR, \".notification__content\").text.strip()\n>               self.fail(\n                    f\"Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\\n\"\n                    f\"Заголовок: '{title}'\\n\"\n                    f\"Содержимое: '{content}'\"\n                )\nE               AssertionError: Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\nE               Заголовок: 'Успешно'\nE               Содержимое: 'Операция одобрена Банком.'\n\ntests\\test_ui.py:514: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_unittest_setUpClass_fixture_TestSuccessfulPurchase","time":{"start":1765832591238,"stop":1765832591238,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0}],"testStage":{"status":"failed","statusMessage":"AssertionError: Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\nЗаголовок: 'Успешно'\nСодержимое: 'Операция одобрена Банком.'","statusTrace":"self = <tests.test_ui.TestSuccessfulPurchase testMethod=test_credit_4442_should_reject_but_approves>\n\n    @allure.feature(\"Покупка в кредит\")\n    @allure.story(\"Баг: Некорректная обработка отказа банка\")\n    @allure.title(\"Карта 4444 4444 4444 4442 должна вызывать ошибку, но вызывает успех (покупка в кредит)\")\n    def test_credit_4442_should_reject_but_approves(self):\n        driver = self.driver\n    \n        with allure.step(\"Нажать кнопку 'Купить в кредит'\"):\n            credit_button = WebDriverWait(driver, 25).until(\n                EC.element_to_be_clickable((By.XPATH,\n                                            \"//button[contains(@class, 'button_view_extra') and contains(@class, 'button_size_m') and contains(@class, 'button_theme_alfa-on-white') and contains(., 'Купить в кредит')]\"))\n            )\n            driver.execute_script(\"arguments[0].scrollIntoView({block: 'center'});\", credit_button)\n            driver.execute_script(\"arguments[0].click();\", credit_button)\n    \n        with allure.step(\"Дождаться формы 'Кредит по данным карты'\"):\n            WebDriverWait(driver, 10).until(\n                EC.visibility_of_element_located((By.XPATH, \"//h3[text()='Кредит по данным карты']\"))\n            )\n    \n        with allure.step(\"Заполнить форму данными карты 4444 4444 4444 4442\"):\n            inputs = driver.find_elements(By.CSS_SELECTOR, \"input.input__control\")\n            inputs[0].send_keys(\"4444 4444 4444 4442\")\n            inputs[1].send_keys(\"08\")\n            inputs[2].send_keys(\"26\")\n            inputs[3].send_keys(\"иван\")\n            inputs[4].send_keys(\"999\")\n    \n        with allure.step(\"Нажать кнопку 'Продолжить'\"):\n            continue_button = WebDriverWait(driver, 10).until(\n                EC.element_to_be_clickable((By.XPATH,\n                                            \"//button[contains(@class, 'button_view_extra') and contains(@class, 'button_size_m') and contains(@class, 'button_theme_alfa-on-white') and not(contains(@class, 'button_disabled')) and contains(., 'Продолжить')]\"))\n            )\n            continue_button.click()\n    \n        with allure.step(\"Дождаться появления ЛЮБОГО уведомления\"):\n            notification = WebDriverWait(driver, 25).until(\n                EC.visibility_of_element_located((By.CSS_SELECTOR, \"div.notification\"))\n            )\n    \n        with allure.step(\"Проверить, что уведомление — НЕ об успехе, а об ошибке\"):\n            notification_class = notification.get_attribute(\"class\")\n    \n            if \"notification_status_ok\" in notification_class:\n                title = notification.find_element(By.CSS_SELECTOR, \".notification__title\").text.strip()\n                content = notification.find_element(By.CSS_SELECTOR, \".notification__content\").text.strip()\n>               self.fail(\n                    f\"Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\\n\"\n                    f\"Заголовок: '{title}'\\n\"\n                    f\"Содержимое: '{content}'\"\n                )\nE               AssertionError: Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\nE               Заголовок: 'Успешно'\nE               Содержимое: 'Операция одобрена Банком.'\n\ntests\\test_ui.py:514: AssertionError","steps":[{"name":"Нажать кнопку 'Купить в кредит'","time":{"start":1765832619493,"stop":1765832619628,"duration":135},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Дождаться формы 'Кредит по данным карты'","time":{"start":1765832619628,"stop":1765832619657,"duration":29},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Заполнить форму данными карты 4444 4444 4444 4442","time":{"start":1765832619657,"stop":1765832620671,"duration":1014},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Нажать кнопку 'Продолжить'","time":{"start":1765832620671,"stop":1765832620817,"duration":146},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Дождаться появления ЛЮБОГО уведомления","time":{"start":1765832620817,"stop":1765832626058,"duration":5241},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0},{"name":"Проверить, что уведомление — НЕ об успехе, а об ошибке","time":{"start":1765832626058,"stop":1765832626330,"duration":272},"status":"failed","statusMessage":"AssertionError: Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\nЗаголовок: 'Успешно'\nСодержимое: 'Операция одобрена Банком.'\n","statusTrace":"  File \"C:\\Users\\St\\Desktop\\qapy-diplom_v2\\tests\\test_ui.py\", line 514, in test_credit_4442_should_reject_but_approves\n    self.fail(\n    ~~~~~~~~~^\n        f\"Ожидалось уведомление об ОШИБКЕ, но получено об УСПЕХЕ!\\n\"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        f\"Заголовок: '{title}'\\n\"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^\n        f\"Содержимое: '{content}'\"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\St\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\unittest\\case.py\", line 732, in fail\n    raise self.failureException(msg)\n","steps":[],"attachments":[],"parameters":[],"hasContent":true,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":true,"stepsCount":0}],"attachments":[],"parameters":[],"hasContent":true,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":true,"stepsCount":6},"afterStages":[{"name":"_unittest_setUpClass_fixture_TestSuccessfulPurchase::0","time":{"start":1765832740236,"stop":1765832740236,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0}],"labels":[{"name":"story","value":"Баг: Некорректная обработка отказа банка"},{"name":"feature","value":"Покупка в кредит"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_ui"},{"name":"subSuite","value":"TestSuccessfulPurchase"},{"name":"host","value":"Kirilenko"},{"name":"thread","value":"24224-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_ui"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":[]},"source":"da8fde2c22ef2d47.json","parameterValues":[]}